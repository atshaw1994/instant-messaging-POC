<% other_user = @chat.sender == current_user ? @chat.receiver : @chat.sender %>
<div class="chats-page-container">

  <div class="chats-header-section">
    <%= link_to chats_path, class: "chats-btn back" do %>
        <span class="material-symbols-rounded">arrow_back</span>
    <% end %>
  <h2 class="chats-page-title">Chat with <%= other_user.display_name %></h2>
  </div>

  <%# ğŸŒŸ SUBSCRIBE TO REAL-TIME UPDATES ğŸŒŸ %>
  <%= turbo_stream_from @chat, "messages" %>

  <ul id="messages" class="conversation-messages" data-chat-id="<%= @chat.id %>" data-current-user-id="<%= current_user.id %>">
    <% @chat.messages.includes(:user).each do |message| %>
      <li>
        <%= render "messages/message", message: message, current_user_id: current_user.id %>
      </li>
    <% end %>
  </ul>

  <%# Message Submission Form %>
  <%= form_with model: [@chat, @message], html: { data: { controller: "reset-form" } } do |form| %>
    <div class="conversation-new-message-form">
      <%= form.text_field :body, placeholder: "Type your message...", class: "conversation-new-message-input" %>
      <button type="submit" class="conversation-new-message-submit">
        <span class="material-symbols-rounded">send</span>
      </button>
    </div>
  <% end %>

</div>